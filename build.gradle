apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'eclipse'
apply plugin: 'application'


import groovy.sql.Sql
import org.apache.log4j.Logger

repositories {
    mavenCentral()
}

sourceSets {
  main {
    output.resourcesDir = 'WEB-INF/resources'
    output.classesDir   = 'WEB-INF/classes'
  }
}

jar {
    baseName = 'gs-gradle'
    version =  '2.1'
}

//war {
//    archiveName = 'openspecimen.war'
    
//    from zipTree(file('catissuecorecsm.war'))
    
//    classpath 'build/libs/caTissueCommonJar.jar'
    
//}


jar {
    baseName = 'caTissueCommonJar'
    version =  ''
    from sourceSets.main.output.classesDir 
}

task clean_build(type: Delete){
    delete './build'
}

task unzip_bulkoperation_installable (type: Copy) {
    from zipTree(file('bulkoperator.zip'))
    into './build/tmp/bulkoperator'
}

task clean_temp_dir_csmwar(type: Delete) {
    delete './build/tmp/catissuecorecsm'
}

task unpack_cacore_war (type: Copy, dependsOn: 'clean_temp_dir_csmwar') {
    from zipTree(file('catissuecorecsm.war'))
    into './build/tmp/catissuecorecsm'
}

task create_war (type: War) {
    archiveName = 'openspecimen.war'
  
    classpath 'build/libs/caTissueCommonJar.jar'
    
    from ('./') {
        include 'ngweb/**'
        include 'css/**' 
				include 'images/**'
				include 'jss/**'
				include 'javascripts/**'
				include 'deploytempCatissuecore/AdvanceQuery/dhtml/**'
				include 'dhtml_comp/**' 
				include 'newDhtmlx/**' 
				include 'dhtmlx_suite/**'
				include 'dhtmlxSuite_v35/**' 
				include 'pages/**' 
				include 'flexclient/**'
				include 'runtime/**' 
				include 'WEB-INF/**' 
				
				include 'CDEConfig.xml' 
				include 'CDEConfig.xsd' 
				include 'client-config.wsdd' 
				include 'Applet/**' 
				include 'ApplicationVersionInfo.txt' 
				include 'caTissue_Suite_User_Manual.pdf' 
				include 'caTissue_Suite_User_Manual.doc' 
				include 'caTissueSuite_v1_2_Technical_Guide.doc' 
				include 'caTissueSuiteV11_UML.zip'  
				include 'ParticipantConfigXMLTemplateRules.xml' 
				
				exclude '**/WEB-INF/src*/**'
    }
    
    from ('build/tmp/catissuecorecsm') { 
        include '**/images/**'
        include '**/WEB-INF/**'
        include '**/log/**'
        
        include '**/Accessibility.jsp'
        include '**/ApplicationSupport.jsp'
        include '**/Classes.jsp'
        include '**/ContactUs.jsp'
        include '**/Disclaimer.jsp'
        include '**/Packages.jsp'
        include '**/PrivacyNotice.jsp'
        include '**/Result.jsp'
        
        include '**/index.html'
        include '**/script.js'
        include '**/styleSheet.css'
        
        exclude '**/WEB-INF/web.xml'
        exclude '**/WEB-INF/classes/edu/wustl/catissuecore/domain/**'
				exclude '**/WEB-INF/lib/activation.jar'
				exclude '**/WEB-INF/lib/ant.jar'
				exclude '**/WEB-INF/lib/antlr-2.7.6.jar'
				exclude '**/WEB-INF/lib/ant-testutil.jar'
				
				exclude '**/WEB-INF/lib/asm-attrs.jar'
				exclude '**/WEB-INF/lib/axis.jar'
				exclude '**/WEB-INF/lib/axis-ant.jar'
				exclude '**/WEB-INF/lib/backport-util-concurrent-3.0.jar'
				
				exclude '**/WEB-INF/lib/c3p0-0.9.0.jar'
				
				exclude '**/WEB-INF/lib/cglib-2.1.3.jar'
			
				exclude '**/WEB-INF/lib/codegen.jar'
				exclude '**/WEB-INF/lib/commons-beanutils.jar'
				exclude '**/WEB-INF/lib/commons-collections-3.1.jar'
				exclude '**/WEB-INF/lib/commons-collections-3.2.jar'
				exclude '**/WEB-INF/lib/commons-dbcp-1.2.1.jar'
				exclude '**/WEB-INF/lib/commons-discovery-0.2.jar'
				exclude '**/WEB-INF/lib/commons-lang-2.1.jar'
				exclude '**/WEB-INF/lib/commons-pool-1.3.jar'
				exclude '**/WEB-INF/lib/csmapi.jar'
				exclude '**/WEB-INF/lib/datafile.jar'
				exclude '**/WEB-INF/lib/db2java.jar'
				exclude '**/WEB-INF/lib/dom4j-1.6.1.jar'
				exclude '**/WEB-INF/lib/dtsrpcclient.jar'
				exclude '**/WEB-INF/lib/freemarker.jar'
				exclude '**/WEB-INF/lib/freemarker-2.3.4.jar'
				exclude '**/WEB-INF/lib/hibernate3.jar'
				exclude '**/WEB-INF/lib/jakarta-oro-2.0.8.jar'
				exclude '**/WEB-INF/lib/jalopy-1.0b11.jar'
				exclude '**/WEB-INF/lib/jalopy-ant-0.6.2.jar'
				exclude '**/WEB-INF/lib/jaxen-jdom.jar'
				exclude '**/WEB-INF/lib/jaxrpc.jar'
				exclude '**/WEB-INF/lib/jboss-client.jar'
				
				exclude '**/WEB-INF/lib/jdtcore.jar'
				exclude '**/WEB-INF/lib/jetc-task.jar'
				exclude '**/WEB-INF/lib/jmiutils.jar'
				exclude '**/WEB-INF/lib/jta.jar'
				exclude '**/WEB-INF/lib/junit-3.8.1.jar'
				exclude '**/WEB-INF/lib/mail.jar'
				exclude '**/WEB-INF/lib/mdrant.jar'
				exclude '**/WEB-INF/lib/mdrapi.jar'
				exclude '**/WEB-INF/lib/Metaphrase.jar'
				exclude '**/WEB-INF/lib/mof.jar'
				exclude '**/WEB-INF/lib/mysql-connector-java-3.1.13-bin.jar'
				exclude '**/WEB-INF/lib/nbmdr.jar'
				exclude '**/WEB-INF/lib/ognl-2.6.7.jar'
				exclude '**/WEB-INF/lib/ojdbc14.jar'
				exclude '**/WEB-INF/lib/openide-util.jar'
				exclude '**/WEB-INF/lib/osgi.jar'
				exclude '**/WEB-INF/lib/p6spy.jar'
				exclude '**/WEB-INF/lib/resources.jar'
				exclude '**/WEB-INF/lib/retrotranslator-runtime-1.2.0.jar'
				exclude '**/WEB-INF/lib/retrotranslator-transformer-1.2.0.jar'
				exclude '**/WEB-INF/lib/runtime.jar'
				exclude '**/WEB-INF/lib/saaj.jar'
				exclude '**/WEB-INF/lib/serializer.jar'
				exclude '**/WEB-INF/lib/struts2-api-j4-2.0.5.jar'
				exclude '**/WEB-INF/lib/struts2-core-j4-2.0.5.jar'
				exclude '**/WEB-INF/lib/uml-1.3.jar'
				exclude '**/WEB-INF/lib/uuid-key-generator.jar'
				exclude '**/WEB-INF/lib/wsdl4j-1.5.1.jar'
				exclude '**/WEB-INF/lib/xalan.jar'
				exclude '**/WEB-INF/lib/xercesImpl.jar'
				exclude '**/WEB-INF/lib/xml-apis.jar'
				exclude '**/WEB-INF/lib/xmlrpc-2.0.jar'
				exclude '**/WEB-INF/lib/xwork-j4-2.0.0.jar'
				exclude '**/META-INF/**'
				exclude 'Happy.jsp'
				exclude 'Criteria.jsp'
				exclude '**/WEB-INF/classes/ApplicationSecurityConfig.xml'
    }
}

task common_build_war (dependsOn:'create_war') {
}

common_build_war.shouldRunAfter unpack_cacore_war

task build_war (dependsOn:['clean_build','unpack_cacore_war','common_build_war']) { 
}

task bulkoperation_integrate_app {
    
}

task integrate_bulk_operation {
    unzip_bulkoperation_installable.execute()
    bulkoperation_integrate_app.execute()
}

task instrument {
}

task compileTestCases (dependsOn:'test') {
  
}

dependencies {
    compile group: 'mysql', name: 'mysql-connector-java', version: '5.0.8'
    
    compile group: 'com.google.code.gson', name: 'gson', version: '2.2.2'
    
    compile group: 'javax', name:'javaee-endorsed-api', version:'6.0'
    
    compile group: 'org.codehaus.jackson', name: 'jackson-core-asl', version: '1.9.2'
    compile group: 'org.codehaus.jackson', name: 'jackson-jaxrs', version: '1.9.2'
    compile group: 'org.codehaus.jackson', name: 'jackson-mapper-asl', version: '1.9.2'
    compile group: 'org.codehaus.jackson', name: 'jackson-xc', version: '1.9.2'
    compile group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.2.0'
    compile group: 'com.fasterxml.jackson.core', name: 'jackson-annotations', version: '2.2.0'
      
    compile group: 'ant', name: 'ant-jakarta-oro', version: '1.6'
    
    compile group: 'com.sun.jersey', name: 'jersey-client', version: '1.17'
    compile group: 'com.sun.jersey', name: 'jersey-core', version: '1.17'
    compile group: 'com.sun.jersey', name: 'jersey-json', version: '1.17'
    compile group: 'com.sun.jersey', name: 'jersey-server', version: '1.17'
    compile group: 'com.sun.jersey', name: 'jersey-servlet', version: '1.17'
    compile group: 'com.sun.jersey', name: 'jersey-bundle', version: '1.8'
    
    compile group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.0.2'
    compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.0.2'
    compile group: 'org.apache.logging.log4j', name: 'log4j-jcl', version: '2.0.2'
    compile group: 'org.apache.logging.log4j', name: 'log4j-slf4j-impl', version: '2.0.2'
    compile group: 'org.apache.logging.log4j', name: 'log4j-web', version: '2.0.2'
    compile group: 'org.apache.logging.log4j', name: 'log4j-taglib', version: '2.0.2'
    compile group: 'org.apache.logging.log4j', name: 'log4j-to-slf4j', version: '2.0.2'
    
    compile group: 'org.hibernate', name: 'hibernate', version: '3.0'
    
    compile group: 'aopalliance', name: 'aopalliance', version: '1.0'
    
    compile group: 'asm', name: 'asm', version: '3.0'
    compile group: 'asm', name: 'asm-tree', version: '3.0'
    
    compile group: 'org.aspectj', name: 'aspectjweaver', version: '1.6.6'
    
    testCompile group: 'junit', name: 'junit', version: '4.11'
    
    compile group: 'net.sf.kxml',name: 'kxml2-min',version: '2.3.0'
    
    compile group: 'org.apache.lucene', name: 'lucene-core', version: '2.0.0'
    
    compile group: 'net.sf.opencsv', name: 'opencsv', version: '1.8'
    
    compile group: 'org.springframework',name:'spring-aop', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-beans', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-context', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-core', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-expression', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-jdbc', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-orm', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-test', version: '3.1.1.RELEASE'
    compile group: 'org.springframework',name:'spring-tx', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-web', version: '3.2.5.RELEASE'
    compile group: 'org.springframework',name:'spring-webmvc', version: '3.2.5.RELEASE'
    compile group: 'org.springframework.security',name:'spring-security-core', version: '3.2.0.RELEASE'
    
    compile group: 'org.mockito', name:'mockito-all', version: '1.9.5'
    
    compile group: 'com.thoughtworks.xstream', name: 'xstream', version: '1.4.4'
    compile group: 'com.thoughtworks.xstream', name: 'xstream-hibernate', version: '1.4.4'
    
    compile group: 'commons-io', name: 'commons-io', version: '2.4'
    compile group: 'org.apache.openejb', name: 'commons-dbcp-all', version: '1.3'
    compile group: 'commons-fileupload', name: 'commons-fileupload', version: '1.2.1'
    compile group: 'commons-collections', name: 'commons-collections', version: '3.2'
    compile group: 'commons-codec', name: 'commons-codec', version: '1.3'
    
    compile files('WEB-INF/lib/AdvanceQuery.jar')
    compile files('WEB-INF/lib/axis.jar')
    compile files('WEB-INF/lib/backport-util-concurrent.jar')
    compile files('WEB-INF/lib/BulkEMPIOperations.jar')
    compile files('WEB-INF/lib/bulkoperator.jar')
    compile files('WEB-INF/lib/castor-0.9.9.jar')
    compile files('WEB-INF/lib/caTissueCdmsIntegration.jar')
    compile files('WEB-INF/lib/catissuecore-client.jar')
    compile files('WEB-INF/lib/cglib.jar')
    compile files('WEB-INF/lib/cobertura.jar')
    compile files('WEB-INF/lib/com.ibm.mqjms.jar')
    compile files('WEB-INF/lib/commonpackage-1.3.1.jar')
    compile files('WEB-INF/lib/commons-beanutils-1.8.3-1.0.jar')
    compile files('WEB-INF/lib/commons-digester.jar')
    compile files('WEB-INF/lib/commons-digester3-3.0-1.0.jar')
    compile files('WEB-INF/lib/commons-lang.jar')
    compile files('WEB-INF/lib/commons-logging.jar')
    compile files('WEB-INF/lib/csmapi.jar')
    compile files('WEB-INF/lib/DAO-1.1.9.7.jar')
    compile files('WEB-INF/lib/Default_label_barcode_gen.jar')
    compile files('WEB-INF/lib/dhtmlxconnector.jar')
    compile files('WEB-INF/lib/dynamicextensions-legacy.jar')
    compile files('WEB-INF/lib/DynamicExtensions.jar')
    compile files('WEB-INF/lib/flex-acrobat.jar')
    compile files('WEB-INF/lib/flex-bootstrap-jsp.jar')
    compile files('WEB-INF/lib/flex-bootstrap.jar')
    compile files('WEB-INF/lib/flex-messaging-common.jar')
    compile files('WEB-INF/lib/flex-messaging-opt.jar')
    compile files('WEB-INF/lib/flex-messaging-req.jar')
    compile files('WEB-INF/lib/flex-messaging.jar')
    compile files('WEB-INF/lib/IDPAuthenticationManager0_0.jar')
    compile files('WEB-INF/lib/IdPJar.jar')
    compile files('WEB-INF/lib/itextpdf-5.3.5.jar')
    compile files('WEB-INF/lib/hibernate3.jar')
    compile files('WEB-INF/lib/jaws.jar')
    compile files('WEB-INF/lib/jaxb-impl.jar')
    compile files('WEB-INF/lib/jaxb-libs.jar')
    compile files('WEB-INF/lib/jaxb-xjc.jar')
    compile files('WEB-INF/lib/jep-2.4.1.jar')
    compile files('WEB-INF/lib/json.jar')
    compile files('WEB-INF/lib/jstl.jar')
    compile files('WEB-INF/lib/mail.jar')
    compile files('lib/log4j.jar')
    compile files('WEB-INF/lib/ojdbc14.jar')
    compile files('WEB-INF/lib/ParticipantManager.jar')
    compile files('WEB-INF/lib/PrintCatissueCore_Client.jar')
    compile files('WEB-INF/lib/printservice_client.jar')
    compile files('WEB-INF/lib/printservice_module.jar')
    compile files('WEB-INF/lib/quartz.jar')
    compile files('WEB-INF/lib/servlet.jar')
    compile files('WEB-INF/lib/Stinger-2.6.1.jar')
    compile files('WEB-INF/lib/SimpleQuery-1.1.9.2.2.jar')
    compile files('WEB-INF/lib/securityManager-1.1.7.2.jar');
    compile files('WEB-INF/lib/spring-cache.jar')
    compile files('WEB-INF/lib/struts.jar')
    compile files('WEB-INF/lib/struts-legacy.jar')
    compile files('WEB-INF/lib/titli-washu-1.0.jar')
    compile files('WEB-INF/lib/velocity-dep-1.5.jar')
    compile files('WEB-INF/lib/washu-commons-1.2.w1.jar')
    
    compile files('deploytempCatissuecore/catissuecore/WEB-INF/lib/ehcache-1.2.2.jar')
    compile files('lib/j2ee.jar')
}