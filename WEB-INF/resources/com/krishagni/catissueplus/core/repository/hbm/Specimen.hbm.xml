<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping auto-import="false">
  <class 
    name="com.krishagni.catissueplus.core.biospecimen.domain.Specimen"
    table="CATISSUE_SPECIMEN" 
    lazy="true">
    
    <id 
      name="id" 
      column="IDENTIFIER" 
      type="long">
			
      <generator class="native">
        <param name="sequence">CATISSUE_SPECIMEN_SEQ</param>
      </generator>
    </id>

    <many-to-one 
      name="parentSpecimen"
      class="com.krishagni.catissueplus.core.biospecimen.domain.Specimen"
      column="PARENT_SPECIMEN_ID" />

    <set 
      name="childSpecimens" 
      table="CATISSUE_SPECIMEN" 
      inverse="true"
      cascade="all">

      <key column="PARENT_SPECIMEN_ID"/>
      <one-to-many
        class="com.krishagni.catissueplus.core.biospecimen.domain.Specimen" />

    </set>

    <property 
      name="initialQuantity" 
      type="double" 
      column="INITIAL_QUANTITY" />

    <property 
      name="pathologicalStatus" 
      type="string"
      column="PATHOLOGICAL_STATUS" />

    <property 
      name="lineage" 
      type="string" 
      column="LINEAGE" />

    <property 
      name="specimenClass" 
      type="string" 
      column="SPECIMEN_CLASS" />

    <property 
      name="specimenType" 
      type="string" 
      column="SPECIMEN_TYPE" />

    <property 
      name="concentrationInMicrogramPerMicroliter" 
      type="double"
      column="CONCENTRATION" />

    <set name="biohazards" 
      table="CATISSUE_SPECIMEN_BIOHZ_REL"
      sort="unsorted">
      <key column="SPECIMEN_ID"/>

      <many-to-many 
        class="com.krishagni.catissueplus.core.administrative.domain.Biohazard"
	column="BIOHAZARD_ID" />
    </set>

    <set name="externalIdentifiers" 
      table="CATISSUE_EXTERNAL_IDENTIFIER"
      inverse="true" 
      cascade="all-delete-orphan">

      <key column="SPECIMEN_ID"/>
      <one-to-many class="com.krishagni.catissueplus.core.biospecimen.domain.ExternalIdentifier" />
    </set>

    <one-to-one 
      name="specimenPosition"
      class="com.krishagni.catissueplus.core.biospecimen.domain.SpecimenPosition" 
      cascade="all"
      property-ref="specimen" />

    <property 
      name="label" 
      type="string" 
      column="LABEL" />

    <property 
      name="isAvailable" 
      type="boolean" 
      column="AVAILABLE" />

    <property 
      name="comment" 
      type="string" 
      column="COMMENTS" />

    <property 
      name="activityStatus" 
      type="string" 
      column="ACTIVITY_STATUS" />

    <property 
      name="collectionStatus" 
      type="string" 
      column="COLLECTION_STATUS" />

    <property 
      name="barcode" 
      type="string" 
      column="BARCODE" />

    <property 
      name="createdOn" 
      type="date" 
      column="CREATED_ON_DATE" />

    <property 
      name="availableQuantity" 
      type="double" 
      column="AVAILABLE_QUANTITY" />

    <property 
      name="tissueSide" 
      type="string" 
      column="TISSUE_SIDE" />
		
    <property 
      name="tissueSite" 
      type="string" 
      column="TISSUE_SITE" />

    <many-to-one 
      name="specimenCollectionGroup"
      class="com.krishagni.catissueplus.core.biospecimen.domain.SpecimenCollectionGroup"
      column="SPECIMEN_COLLECTION_GROUP_ID" />

    <many-to-one 
      name="specimenRequirement"
      class="com.krishagni.catissueplus.core.biospecimen.domain.SpecimenRequirement" 
      column="REQ_SPECIMEN_ID" />
			
    <query name="getSpecimenByLabel">
      from 
        com.krishagni.catissueplus.core.biospecimen.domain.Specimen
      where
        label = :label
    </query>
	  
    <query name="getSpecimenByBarcode">
      from 
        com.krishagni.catissueplus.core.biospecimen.domain.Specimen
      where
        barcode = :barcode
    </query>
  </class>
</hibernate-mapping>
